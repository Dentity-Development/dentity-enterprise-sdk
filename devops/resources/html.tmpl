{{/* Set URL base for embedded links to types, so that they can be resolved correctly when this generated markdown is injected into other pages */}}
{{$url_base := "/reference/proto"}}

# Protocol Documentation
<a name="top"></a>

This page documents the Protobuf Services and Messages which compose the Trinsic API.

{{range .Files}}
{{$file_name := .Name}}
<a name="{{.Name | anchor}}"></a>
<p align="right"><a href="#top">Top</a></p>

## {{.Name}}
{{.Description}}

{{range .Services}}
<a name="{{.FullName | anchor}}"></a>

### Service - {{.Name}}
{{.Description}}

| Method Name | Request Type | Response Type | Description |
| ----------- | ------------ | ------------- | ------------|
{{range .Methods -}}
  | {{.Name}} | [{{.RequestLongType}}]({{$url_base}}#{{.RequestFullType | anchor}}){{if .RequestStreaming}} stream{{end}} | [{{.ResponseLongType}}]({{$url_base}}#{{.ResponseFullType | anchor}}){{if .ResponseStreaming}} stream{{end}} | {{nobr .Description}} |
{{end}}
{{end}} <!-- end services -->

<!-- start messages -->
{{range .Messages}}
  <div class="proto-obj-container" data-proto-name="{{.FullName | anchor}}">
    <div class="proto-obj-name"><a name="{{.FullName | anchor}}" href="/reference/proto#{{.FullName | anchor}}">{{.LongName}}</a></div>
    <div class="proto-obj-description" markdown>{{.Description}}</div>
    
    {{if .HasFields}}
      <div class="proto-obj-fields" markdown>
        {{range .Fields -}}
        
        {{$field_is_primitive := false}}
        {{if eq .Type "double" "float" "int32" "int64" "uint32" "uint64" "sint32" "sint64" "fixed32" "fixed64" "sfixed32" "sfixed64" "bool" "string" "bytes"}}
          {{$field_is_primitive = true}}
        {{end}}

          <div class="proto-field">
            <div class="proto-field-name">{{.Name}}</div>
            <div class="proto-field-type">
              {{if eq $field_is_primitive true}}
                {{.Type}}
              {{else}}
                <a href="{{$url_base}}#{{.FullType | anchor}}">{{.Type}}</a>{{if eq .Label "repeated"}}[]{{end}}
              {{end}}
            </div>
            <div class="proto-field-description">{{if (index .Options "deprecated"|default false)}}**Deprecated.** {{end}}{{nobr .Description}}{{if .DefaultValue}} Default: {{.DefaultValue}}{{end}}</div>
            {{if eq $field_is_primitive false}}
              {{if eq .Type "ConfirmationMethod"}}
              {{else}}
                <div class="proto-field-expand-btn" onclick="onClick(this, '{{.FullType | anchor}}');">Show child attributes</div>
                <div class="proto-field-sub-child empty hidden"></div>
              {{end}}
            {{end}}
          </div>
        {{end}}
      </div>
    {{end}}
  </div>
{{end}} 
<!-- end messages -->

{{range .Enums}}
<a name="{{.FullName | anchor}}"></a>

### {{.LongName}}
{{.Description}}

| Name | Number | Description |
| ---- | ------ | ----------- |
{{range .Values -}}
  | {{.Name}} | {{.Number}} | {{nobr .Description}} |
{{end}}

{{end}} <!-- end enums -->

{{if .HasExtensions}}
<a name="{{$file_name | anchor}}-extensions"></a>

### File-level Extensions
| Extension | Type | Base | Number | Description |
| --------- | ---- | ---- | ------ | ----------- |
{{range .Extensions -}}
  | {{.Name}} | {{.LongType}} | {{.ContainingLongType}} | {{.Number}} | {{nobr .Description}}{{if .DefaultValue}} Default: `{{.DefaultValue}}`{{end}} |
{{end}}
{{end}} <!-- end HasExtensions -->

{{end}}

## Scalar Value Types

| .proto Type | Notes | C++ | Java | Python | Go | C# | PHP | Ruby |
| ----------- | ----- | --- | ---- | ------ | -- | -- | --- | ---- |
{{range .Scalars -}}
  | <a name="{{.ProtoType | anchor}}" /> {{.ProtoType}} | {{.Notes}} | {{.CppType}} | {{.JavaType}} | {{.PythonType}} | {{.GoType}} | {{.CSharp}} | {{.PhpType}} | {{.RubyType}} |
{{end}}